<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>30Hills</title>

    <link href='/static/css/bootstrap.css' rel='stylesheet' type='text/css'/>
    <link href='/static/css/site.css' rel='stylesheet' type='text/css'/>

    <script src="/static/js/angular.min.js"></script>
    <!--<script src="/static/js/angular-ui-router.min.js"></script>-->
    <script src="/static/js/ui-bootstrap-tpls-0.12.0.min.js"></script>
    <script src="/static/js/main.js"></script>
</head>
<body ng-app="hillsbook">
<div id="mainPage" ng-controller="UsersCtrl">

    <header>
        <h1>30Hillbook</h1>
    </header>
    <nav>
        <div id="selectPerson" class="tulbar">
            <select class="form-control" ng-options="u.id as u.first_name + ' ' + u.last_name for u in users"
                    ng-change="reloadUser()" ng-model="userId">
            </select>
        </div>
        <div id="searchPerson" class="tulbar">
            <input type="text" class="form-control" ng-model="searchUserText" typeahead-wait-ms="150"
                   typeahead-min-length="1" placeholder="(Search users)" typeahead-on-select="reloadUserId(searchUserText.id)"
             typeahead="u as u.first_name + ' ' + u.last_name for u in searchUsers($viewValue)"  />

            <!--<input type="text" class="form-control"-->
             <!--typeahead-wait-ms="150" typeahead-min-length="1"-->
             <!--typeahead="user as user for user in searchUsers1($viewValue) | filter:$viewValue"  />-->
            <!--.first_name + ' ' + user.last_name-->
        </div>
        <div class="tulbar">
            <button class="btn btn-info" ng-click="openUserEditModal()">Edit person</button>
            <button class="btn btn-info" ng-click="openUserAddModal()">+ Add person</button>
        </div>
    </nav>

    <div class="row">
        <section class="col-sm-5 col-xs-12" ng-class="(user.gender=='male') ? 'boy-name' : 'girl-name'">

            <h3 class="col-sm-offset-1">
                <img ng-src="/img/{{(user.gender=='male') ? 'male':'female'}}.png" alt="No image"/>
                {{ user.first_name }} {{ user.last_name }}
            </h3>
            <table class="table user-info-table col-sm-offset-1">
                <tr>
                    <td class="col-sm-1">gender:</td>
                    <td class="col-sm-1">{{user.gender}}</td>
                </tr>
                <tr>
                    <td>age:</td>
                    <td>{{user.age}}</td>
                </tr>
                <tr>
                    <td>
                        <label for="addFriend">Add friend: </label>
                    </td>
                    <td>
                        <select class="form-control" id="addFriend"
                                ng-options="u.id as u.first_name + ' ' + u.last_name for u in users"
                                ng-change="addFriend(addFriendId)" ng-model="addFriendId">
                            <option value=''>- Choose -</option>
                        </select>
                    </td>
                </tr>
            </table>
        </section>

        <aside class="col-sm-6 col-sm-offset-1 col-xs-12">
            <tabset>
                <tab heading="Friends" active select="reloadUserInfo(1)">
                    <p ng-show="!userInfo.friends.length">No friends to show</p>
                    <ul class="user-list">
                        <li ng-repeat="u in userInfo.friends">
                            <a href ng-click="reloadUserId(u.id)">{{ u.first_name }} {{ u.last_name }}</a>
                            <a href class="friend-unfriend" ng-click="removeFriend(u.id)">[unfriend]</a>
                        </li>
                    </ul>

                </tab>
                <tab heading="Friends of friends" select="reloadUserInfo(2)">
                    <p ng-show="!userInfo.fof.length">No friends of friends to show</p>
                    <ul class="user-list">
                        <li ng-repeat="u in userInfo.fof">
                            <a href ng-click="reloadUserId(u.id)">{{ u.first_name }} {{ u.last_name }}</a>
                            <a href class="friend-unfriend" ng-click="addFriend(u.id)">[add friend]</a>
                        </li>
                    </ul>
                </tab>
                <tab heading="Suggested friends" select="reloadUserInfo(3)">
                    <p ng-show="!userInfo.suggestions.length">No suggestions to show</p>
                    <ul class="user-list">
                        <li ng-repeat="u in userInfo.suggestions">
                            <a href ng-click="reloadUserId(u.id)">{{ u.first_name }} {{ u.last_name }}</a>
                            <a href class="friend-unfriend" ng-click="addFriend(u.id)">[add friend]</a>
                        </li>
                    </ul>
                </tab>
            </tabset>
        </aside>
    </div>


    <script type="text/ng-template" id="userEditTemplate.html">
        <div class="modal-header">
            <h3 class="modal-title">User Info</h3>
        </div>
        <div class="modal-body">


            <form name="userForm" novalidate role="form" class="form-horizontal">
                <div class="form-group"
                     ng-class="{'has-error':userForm.userFirstName.$invalid && userForm.userFirstName.$dirty}">
                    <label for="userFirstName" class="col-sm-3 control-label">First name:</label>

                    <div class="col-sm-8">
                        <input id="userFirstName" name="userFirstName" type="text" required ng-maxlength="20"
                               ng-model="newUser.first_name" class="form-control"
                               placeholder="First Name (Required)"/>
                        <span class="help-block has-error"
                              ng-show="userForm.userFirstName.$error.maxlength">Too long</span>

                    </div>
                </div>

                <div class="form-group"
                     ng-class="{'has-error':userForm.userLastName.$invalid && userForm.userLastName.$dirty}">
                    <label for="userLastName" class="col-sm-3 control-label">Last name:</label>

                    <div class="col-sm-8">
                        <input id="userLastName" name="userLastName" type="text" ng-maxlength="20"
                               ng-model="newUser.last_name" class="form-control"
                               placeholder="Last Name"/>
                        <span class="help-block has-error"
                              ng-show="userForm.userLastName.$error.maxlength">Too long</span>
                    </div>
                </div>
                <div class="form-group" ng-class="{'has-error':userForm.userAge.$invalid && userForm.userAge.$dirty}">
                    <label for="userAge" class="col-sm-3 control-label">Age:</label>

                    <div class="col-sm-4">
                        <input id="userAge" name="userAge" ng-pattern="/^(\d)+$/"
                               ng-model="newUser.age" class="form-control"
                               placeholder="Age"/>
                    </div>
                </div>
                <div class="form-group">
                    <label for="userGender" class="col-sm-3 control-label">Gender:</label>

                    <div class="col-sm-5">
                        <select id="userGender" name="userGender" class="form-control" ng-model="newUser.gender">
                            <option value="" selected disabled>Select gender</option>
                            <option value="female">Female</option>
                            <option value="male">Male</option>
                        </select>
                    </div>
                </div>

            </form>
        </div>
        <div class="modal-footer">
            <button ng-if="editMode" class="btn btn-danger pull-left" ng-click="userDelete()">Delete person</button>

            <button class="btn btn-primary" ng-disabled="userForm.$invalid" ng-click="userEditOk()">Save changes
            </button>
            <button class="btn" ng-click="userEditCancel()">Cancel</button>
        </div>

    </script>

</div>


</body>
</html>
